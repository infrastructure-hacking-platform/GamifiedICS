services:
  EV-charger:
    image: rastasheep/ubuntu-sshd
    container_name: EV-charger
    command: bash -c "apt update && apt install -y net-tools && apt install -y iputils-ping && /usr/sbin/sshd -D"
    networks:
      network_EV-charger:
        ipv4_address: 192.168.100.101

  OpenPLC_EV-charger:
    image: openplc-docker
    container_name: OpenPLC_EV-charger
    ports:
      - "8083:8080"
      - "502:502"
    command: "/home/openplc/run.sh"
    volumes:
      - /home/user/test/OpenPLC:/home/openplc/scripts
    networks:
      network_EV-charger:
        ipv4_address: 192.168.100.200


  Monorail:
    image: rastasheep/ubuntu-sshd
    container_name: Monorail
    command: bash -c "apt update && apt install -y net-tools && apt install -y iputils-ping && /usr/sbin/sshd -D"
    networks:
      network_Monorail:
        ipv4_address: 192.168.101.101

  OpenPLC_Monorail:
    image: openplc-docker
    container_name: OpenPLC_Monorail
    ports:
      - "8084:8080"
      - "503:502"
    command: "/home/openplc/run.sh"
    volumes:
      - /home/user/test/OpenPLC:/home/openplc/scripts
    networks:
      network_Monorail:
        ipv4_address: 192.168.101.200


  sql-server_Power-plant:
    container_name: sql-server_Power-plant
    image: mysql
    environment:
      MYSQL_ROOT_PASSWORD: rootpassword
      MYSQL_DATABASE: db_Power-plant
      MYSQL_USER: user
      MYSQL_PASSWORD: password
    volumes:
      - sql-server_data_Power-plant:/var/lib/mysql
    networks:
      network_Power-plant:
        ipv4_address: 192.168.102.3

# Wordpress container (Power plant)
  wordpress_Power-plant:
    container_name: wordpress_Power-plant
    image: wordpress:latest
    privileged: true
    ports:
      - "8000:80"
    cap_add:
      - NET_ADMIN
    security_opt:
      - apparmor:unconfined
    environment:
      WORDPRESS_DB_HOST: sql-server_Power-plant
      WORDPRESS_DB_USER: user
      WORDPRESS_DB_PASSWORD: password
      WORDPRESS_DB_NAME: db_Power-plant
    volumes:
      - wordpress_data_Power-plant:/var/www/html
    depends_on:
      - sql-server_Power-plant
    networks:
      network_Power-plant:
        ipv4_address: 192.168.102.2

  Cooling-pump_Power-plant:
    image: rastasheep/ubuntu-sshd
    container_name: Cooling-pump_Power-plant
    command: bash -c "apt update && apt install -y net-tools && apt install -y iputils-ping && /usr/sbin/sshd -D"
    cap_add:
      - NET_ADMIN
    security_opt:
      - apparmor:unconfined
    networks:
      network_Power-plant:
        ipv4_address: 192.168.102.10

  Geiger-counter_Power-plant:
    image: rastasheep/ubuntu-sshd
    container_name: Geiger-counter_Power-plant
    command: bash -c "apt update && apt install -y net-tools && apt install -y iputils-ping && /usr/sbin/sshd -D"
    networks:
      network_Power-plant:
        ipv4_address: 192.168.102.11

  OpenPLC_Power-plant:
    image: openplc-docker
    container_name: OpenPLC_Power-plant
    ports:
      - "8085:8080"
      - "504:502"
    command: "/home/openplc/run.sh"
    volumes:
      - /home/user/test/OpenPLC:/home/openplc/scripts
    networks:
      network_Power-plant:
        ipv4_address: 192.168.102.200


volumes:
  mysql_data_EV-charger:
  mysql_data_Monorail:
  sql-server_data_Power-plant:
  wordpress_data_Power-plant:

networks:
  network_EV-charger:
    driver: bridge
    ipam:
      config:
        - subnet: 192.168.100.0/24
  network_Monorail:
    driver: bridge
    ipam:
      config:
        - subnet: 192.168.101.0/24
  network_Power-plant:
    driver: bridge
    ipam:
      config:
        - subnet: 192.168.102.0/24

#networks:
#  network_EV-charger:
#    external: true
#  network_Monorail:
#    external: true
#  network_Power-plant:
#    external: true